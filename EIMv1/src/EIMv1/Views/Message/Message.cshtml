@model ContentViewModel
<div id="container">
    <div class="container-fluid message-fill">
        <div class="row message-fill">
            <div class="col-md-height message-user-list col-xs-3 no-float message-fill">
                <div id="message-create">
                    <div class="input-group">
                        <div class="row">
                            <div class="col-xs-2">
                                <button type="button" class="btn btn-default btn-lg white">
                                    <span class="glyphicon glyphicon-menu-hamburger" aria-hidden="true"></span>
                                </button>
                            </div>
                            <div class="col-xs-8">
                                <input type="text" class="form-control" placeholder="Search">
                            </div>
                            <div class="col-xs-2">
                                <button type="button" class="btn btn-default btn-lg btn white">
                                    <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                                </button>
                            </div>
                        </div>
                       
                    </div>
                </div>
                <div class="message-user-list-remain">
                    <div class="list-group">
                        @foreach (var user in Model.Users.users)
                        {
                            <a asp-controller="Message" asp-action="Message" asp-route-id="@user.last_name"  class="list-group-item list-group-item-action">
                                <h5>
                                    @user.first_name @user.last_name
                                </h5>
                            </a>
                        }
                    </div>
              </div>
                
            </div>

            <div class="col-md-height col-xs-9 no-float message-fill panel panel-default message-content">
                <div id="message-to">
                    <div class="row">
                        <div class="col-xs-10">
                            @if(Model.Friend == null)
                            {
                                <h4>no friend </h4>
                            }
                            else
                            {
                                <h4>@Model.Friend.ToString()</h4>
                            }
                        </div>
                        <div class="col-xs-1">
                            <button type="button" class="btn btn-default btn-lg">
                                <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                            </button>
                        </div>
                        <div class="col-xs-1">
                            <button type="button" class="btn btn-default btn-lg btn">
                                <span class="glyphicon glyphicon-option-vertical" aria-hidden="true"></span>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="message-remain">
                    <div id="message-messages">
                        @if (Model.Messages != null)
                        {
                            @if (Model.Messages.messages.Any())
                            {
                                @foreach (var message in Model.Messages.messages)
                                {
                                    <p>@message.user_email - @message.body</p>

                                }

                            }
                            else
                            {

                                <p>No Messages</p>
                            }


                        }
                        else
                        {

                        }
                    </div>
                    <div id="message-write">
                        <textarea id="message-form" ></textarea>
                    </div>
                    <div id="message-lowbar" class="right">
                        <button type="button" class="btn btn-default btn-lg" id="send-button">
                            <span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span> Send
                        </button>
                    </div>
                </div>
                





            </div>
        </div>
    </div>
</div>


@section scripts {

    <script>
        

        $(document).ready(function () {

            $("button#send-button").click(function () {
                var message = $("textarea").val();
                Post('@Model.Friend', message);

            });

        });



        function Post(to, message) {
            var jsonMessage = {
                'to' : to,
                'body': message,
            };
            $.ajax({
                type: 'POST',
                url: '/api/MessageData/',
                data: jsonMessage,
                contentType: 'application/json',
                success: function (jsonData) {
                    if (jsonData == null) {
                        alert('no data returned');
                        return;

                    }
                    alert("success");


                },
                error: function (ex) {
                    alert(ex);
                }
            });
            return false;
        }
    </script>
}